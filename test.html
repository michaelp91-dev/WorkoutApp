<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sound Test (Self-Contained)</title>
    <style>
        body { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            font-family: sans-serif; 
            text-align: center;
            background-color: #222;
            color: white;
        }
        #test-btn {
            padding: 25px 50px;
            font-size: 1.5rem;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div>
        <h1>Audio Playback Test</h1>
        <p>Tap the button below to attempt to play a sound.</p>
        <button id="test-btn">Play Sound</button>
    </div>

    <script>
    !function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Tone={})}(this,(function(t){"use strict";const e=Symbol.for("tone-context-constructor");class i{constructor(t){this.name=t}toString(){return this.name}}const s=new i("time"),n=new i("frequency"),o=new i("transportTime"),r=new i("ticks"),a=new i("number"),l=new i("db"),h=new i("hertz"),u=new i("normalRange"),c=new i("audioRange"),d=new i("positive"),p=new i("bpm"),f=new i("cents"),m=new i("degrees"),g=new i("milliseconds"),y=new i("seconds"),v=new i("decibels"),b=new i("integer"),T=new i("notation"),w=new i("note"),S=new i("midi"),k=new i("transportTime"),x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};var O=x.AudioContext||x.webkitAudioContext,C=new WeakMap,M=new WeakMap;class A{constructor(t){if(C.has(t)){const e=C.get(t);return M.set(A,e),e}M.set(A,this),C.set(t,this),Object.defineProperty(this,"rawContext",{value:t}),this.isOffline=t instanceof(x.OfflineAudioContext||function(){}),this.master=t.destination,this.lookAhead=t.lookAhead,this.updateInterval=t.updateInterval,this.latencyHint=t.latencyHint,this._constants=new Map,this._timeouts=new Set,this._timeoutIds=new WeakMap,this.transport=new Ft(this),this.draw=new Vt(this),this._workletPromise=null,this.destination=new Nt(this,"destination"),this.destination.connect(this.master),this.analyser=new Ut(this,"analyser",{type:"fft",size:2048}),this.destination.chain(this.analyser)}get state(){return this.rawContext.state}get sampleRate(){return this.rawContext.sampleRate}get now(){return this.rawContext.currentTime}get immediate(){return this.rawContext.currentTime}get baseLatency(){return this.rawContext.baseLatency}get outputLatency(){return this.rawContext.outputLatency}resume(){return this.rawContext.resume()}close(){return Promise.all([this.rawContext.close(),this.clearAllTimeouts()]).then(()=>({}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this.rawContext.createBuffer(1,128,this.sampleRate),i=e.getChannelData(0);for(let s=0;s<i.length;s++)i[s]=t;const s=this.rawContext.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=e,s.loop=!0,s.start(0),this._constants.set(t,s),s}}_createWorklet(t,e){this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(t).catch((t=>{throw new Error(`Tone.js: could not load audio worklet: ${e} (${t})`)}))),this._workletPromise}setTimeout(t,e){const i=this.now+e,s=this.rawContext.createBufferSource();s.onended=()=>{this._timeouts.delete(s),this._timeoutIds.has(s)&&(this._timeoutIds.delete(s),t())},s.start(i),this._timeouts.add(s);const n=()=>{this._timeoutIds.has(s)&&(this._timeouts.delete(s),s.onended=null,s.stop(),this._timeoutIds.delete(s))};return this._timeoutIds.set(s,n),n}clearTimeout(t){this._timeoutIds.has(t)&&t()}clearAllTimeouts(){return new Promise((t=>{this._timeouts.forEach((e=>{e.onended=null,e.stop()})),this._timeouts.clear(),t()}))}createAnalyser(){return this.rawContext.createAnalyser()}createBiquadFilter(){return this.rawContext.createBiquadFilter()}createBuffer(t,e,i){return this.rawContext.createBuffer(t,e,i)}createBufferSource(){return this.rawContext.createBufferSource()}createChannelMerger(t){return this.rawContext.createChannelMerger(t)}createChannelSplitter(t){return this.rawContext.createChannelSplitter(t)}createConstantSource(){return this.rawContext.createConstantSource()}createConvolver(){return this.rawContext.createConvolver()}createDelay(t){return this.rawContext.createDelay(t)}createDynamicsCompressor(){return this.rawContext.createDynamicsCompressor()}createGain(){return this.rawContext.createGain()}createIIRFilter(t,e){return this.rawContext.createIIRFilter(t,e)}createOscillator(){return this.rawContext.createOscillator()}createPanner(){return this.rawContext.createPanner()}createPeriodicWave(t,e,i){return this.rawContext.createPeriodicWave(t,e,i)}createStereoPanner(){return this.rawContext.createStereoPanner()}createWaveShaper(){return this.rawContext.createWaveShaper()}createMediaStreamSource(t){return this.rawContext.createMediaStreamSource(t)}createMediaElementSource(t){return this.rawContext.createMediaElementSource(t)}createMediaStreamDestination(){return this.rawContext.createMediaStreamDestination()}decodeAudioData(t){return this.rawContext.decodeAudioData(t)}}function P(t){const i=new A(t);return M.has(A)?M.get(A):i}let D=new O;const E=C.has(D)?C.get(D):P(D);function I(t){if(t instanceof A)return t;if(t instanceof AudioContext)return C.has(t)?C.get(t):P(t);{const i=e in t?t[e]:E;return M.has(A)&&M.get(A).rawContext===i.rawContext?M.get(A):i}}let L,R;function F(){return L||(L=new Promise((async t=>{if(x.TONE_SILENCE_LOGGING)t(void 0);else{const e=`\n            __                                         \n           /\\ \\                                        \n          _\\ \\ \\        __    ___   __  __  __   ____  \n         /\\ \\ \\ \\      / __\`\\ / __\`\\/\\ \\/\\ \\/\\ \\ /  __\\\n        _\\ \\ \\_\\ \\    /\\ \\L\\ \\/\\ \\L\\ \\ \\ \\_/ \\_/ /\\__, \\\n       /\\ \\_\\ \\__ \\   \\ \\____/\\ \\____/\\ \\___x___/\\____/\n       \\/_/ / /  /    \\/___/  \\/___/  \\/ __/ __/ \\/___/ \n          /_/ /  /                                     \n          \\_\\/  /                                      \n\n`,i=["#5599ff","#5f91ff","#6a8aff","#7582ff","#807aff","#8a73ff","#956bff","#a063ff","#ab5cff","#b654ff","#c14cff","#cc45ff","#d73dff","#e136ff","#ec2eff","#f726ff"],s=Math.floor(6*Math.random());console.log("%c"+e,`color: ${i[s]}`)}t(void 0)}))),L}function N(t){return"undefined"!=typeof t}function B(t){return"function"==typeof t}const V=128;function z(t,e){for(let i=0;i<Math.max(t.length,e.length);i++){const s=t[i]||0,n=e[i]||0;if(s>n)return 1;if(n>s)return-1}return 0}class G{constructor(t,e){this.name="Tone",this.version="14.7.77",Object.defineProperty(this,"context",{get:()=>I(this._context),set:t=>{this._context=t,I(t).rawContext!==this._context.rawContext&&this.setContext(t)}}),this._context=E;const i=I(E);if(this.isOffline=i.isOffline,this._context=i,this.debug=I(t).debug,this.verbose=I(t).verbose,t&&t.context){this.context=t.context;const e=I(t.context);e&&(this._context=e,this.isOffline=e.isOffline)}this.isOffline=this._context.isOffline,this.debug=N(t)?t:this.debug,this.verbose=N(e)?e:this.verbose,F()}get now(){return this.context.now}get immediate(){return this.context.immediate}setContext(t){this._context=t,this.isOffline=t.isOffline}get supported(){return N(x.AudioContext)&&B(x.AudioContext)}get unsafari(){return!this.supported||x.navigator.userAgent.toLowerCase().includes("safari")&&!x.navigator.userAgent.toLowerCase().includes("chrome")}get sampleRate(){return this.context.sampleRate}get blockTime(){return V/this.context.sampleRate}get bufferSize(){return this.context.rawContext.destination.context.baseLatency>0?this.context.rawContext.destination.context.sampleRate*this.context.rawContext.destination.context.baseLatency:2*V}get version(){return this.version}}var W=new G;const U=(t,e)=>{const i=W.isOffline?new x.OfflineAudioContext(e,e*t,e):new O({latencyHint:W.latencyHint,sampleRate:e}),s=i.createBuffer(1,t*e,e),n=new A(i);return{context:n,buffer:s,render:async()=>i.startRendering(),dispose:()=>{n.close(),C.delete(i),D=new O,E=P(D)}};function j(t,e,i,s=1,n=!1){const o=t.createBuffer(1,e,t.sampleRate),r=o.getChannelData(0);if(B(i))for(let t=0;t<e;t++){const s=t/e;r[t]=i(s)}else if(Array.isArray(i))if(n)for(let t=0;t<e;t++){const n=Math.floor(t/e*(i.length-1)),o=i[n],a=i[Math.ceil(t/e*(i.length-1))];r[t]=Y(o,a,t/e*(i.length-1)%1)}else for(let t=0;t<i.length;t++)r[t]=i[t];else if(i instanceof Float32Array)for(let t=0;t<i.length;t++)r[t]=i[t];else r[0]=i;if(1!==s){for(let t=0;t<r.length;t++)r[t]*=s;for(let t=1;t<r.length;t++){const e=r[t],i=r[t-1];e>1&&i<1?(r[t-1]=1,r[t]=2-r[t]):e<-1&&i>-1&&(r[t-1]=-1,r[t]=-2-r[t])}return r}}const H={value:0},q=1e-5,K=Math.PI/180,Y=function(t,e,i){return(1-i)*t+i*e};class X{constructor(t,e){this.input=this.output=t,this._context=e}}class Z extends X{constructor(){const t=I(arguments[0]);super(t.createGain(),t),this.blockTime=this.context.blockTime,this.bufferTime=128/this.context.sampleRate,this.fadeTime=this.context.lookAhead}dispose(){return this.input.disconnect(),this}connect(t){return this.output.connect(t.input?t.input:t),this}}class Q extends G{constructor(t){super();const e=tt(t);this.name="ToneWithContext",this._context=e.context,this.isOffline=this.context.isOffline,this.debug=e.debug,this.verbose=e.verbose,this.output=new Z(this.context),this._internalChannels=[this.output]}get now(){return this.context.now}get immediate(){return this.context.immediate}get blockTime(){return this.context.blockTime}get sampleRate(){return this.context.sampleRate}get bufferSize(){return this.context.bufferSize}get unsafari(){return this.context.unsafari}get supported(){return this.context.supported}setContext(t){super.setContext(t),this._internalChannels.forEach((e=>e.setContext(t)))}chain(...t){this.connect(t[0]);for(let e=1;e<t.length;e++)t[e-1].connect(t[e]);return this}fan(...t){t.forEach((t=>this.connect(t)))}connect(t,e=0,i=0){if(t instanceof Q)this.output.connect(t.input,e,i);else if(t instanceof AudioParam)this.output.connect(t,e);else if(t instanceof AudioNode)this.output.connect(t,e,i);else{const s=t,n=this._internalChannels.find((t=>{if(B(s.inputFrom) && s.inputFrom(this,e,i))return!0;if(s.input === t)return!0}));n||(B(s.inputFrom)?s.inputFrom(this,e,i):this.connect(s,e,i))}return this}disconnect(t,e=0,i=0){this.output.disconnect(),t && (t instanceof AudioParam?this.output.output.disconnect(t,e):t instanceof Q?this.output.output.disconnect(t.input,e,i):t instanceof AudioNode?this.output.output.disconnect(t,e,i):B(t.inputFrom)&&t.inputFrom(this,void 0))}dispose(){if(!this.disposed){this.disposed=!0;for(const t of this._internalChannels)t.dispose()}return this}toDestination(){return this.connect(this.context.destination),this}}const J=/^(undefined|number|string|boolean|object|function|symbol)$/;function $(t,e){if(Array.isArray(t))t.forEach($);else if("object"==typeof t&&null!==t)for(const i in t)i.startsWith("_")||$(t[i],e);else J.test(typeof t)&&B(e)&&e(t)}class tt extends Q{constructor(){super(),this.disposed=!1,this.name="ToneObject",this._overridden=new Map,this._scheduledEvents=new Map,this._registered=new Map,this.isUndisposed=!0;const t=this.get.bind(this);Object.defineProperties(this,{get:{value:t}})}_getParam(t){const e=Reflect.get(this,t);return e instanceof $t?e:void 0}set(t,e){if(B(this[t])){const i={};i[t]=e,this.set(i)}else if(N(this[t])&&this[t].value===e)return;if("object"==typeof t){const e={};Object.keys(t).forEach((i=>e[i]=t[i]));const i={...e};for(const s in e){const n=i[s],o=this._getParam(s);if(o){const i=o.units;if(this.options[s]=n,i===a)o.value=n;else if(i===s)o.value=this.toSeconds(n);else if(i===h)o.value=this.toFrequency(n);else if(i===l)o.value=this.toDecibels(n);else if(o.value=n;else if(N(this[s])&&this[s].value===n)this.options[s]=n;else if(B(this[s]))this.options[s]=n,this[s](n);else if("object"==typeof this[s]&&null!==this[s]){const e=this.get(s);B(e.set)?e.set(n):e.value=n}else this[s]=n}else this[t]=e;return this}get(t){if(N(t)){const e=this._getParam(t);return e?this.options[t]:this[t]}const e={};return $(this, (t=>{const i=this._getParam(t);i?e[t]=this.options[t]:B(this[t])||(e[t]=this[t])})),e}toString(){return this.name}dispose(){if(this.isUndisposed){this.isUndisposed=!1;for(const t in this){const e=this._getParam(t);if(e)e.dispose();else if(this[t]instanceof Q)this[t].dispose();else if(B(this.on) && B(this.off)){this.off();const e=this._registered.get(t);N(e)&&B(this.off)&&this.off(e)}else"object"==typeof this[t]&&null!==this[t]&&B(this[t].dispose)&&this[t].dispose()}this._overridden.forEach(((t,e)=>{Reflect.set(this,e,t)})),this.cancelScheduledValues(this.now),this._scheduledEvents.forEach(((t,e)=>this.context.transport.clear(e))),this.disposed=!0}return this}get disposed(){return this._disposed}_assertUndisposed(){this.disposed&&function(t){throw new Error(`${t.toString()} has been disposed and cannot be used.`)}(this)}toSeconds(t){return this.context.toSeconds(t)}toFrequency(t){return this.context.toFrequency(t)}toTicks(t){return this.context.toTicks(t)}}function et(t,e){return Array.isArray(t)?function(t,e){const i={};for(const s of e){if(N(t[s]))i[s]=t[s]}return i}(t,e):{}}class it extends Q{constructor(t){super({context:t.context}),this.name="Param",this.value=t.value,this.units=t.units,this.minValue=t.minValue,this.maxValue=t.maxValue,this.convert=t.convert,this.overridden=t.overridden,this.param=t.param}setValueAtTime(t,e){return this._assertUndisposed(),this.param.setValueAtTime(t,e),this}setRampPoint(t){return this._assertUndisposed(),this.param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._assertUndisposed(),this.param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._assertUndisposed(),this.param.exponentialRampToValueAtTime(t,e),this}setTargetAtTime(t,e,i){return this._assertUndisposed(),this.param.setTargetAtTime(t,e,i),this}setValueCurveAtTime(t,e,i){return this._assertUndisposed(),this.param.setValueCurveAtTime(t,e,i),this}cancelScheduledValues(t){return this._assertUndisposed(),this.param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._assertUndisposed(),this.param.cancelAndHoldAtTime(t),this}rampTo(t,e=0,i=this.now){if(this.overridden){const s=this.context.now;this.cancelScheduledValues(s),this.setValueAtTime(this.value,s),this.linearRampToValueAtTime(t,i+this.toSeconds(e))}else this.setTargetAtTime(t,i,this.toSeconds(e));return this}}class st{constructor(t,e,i){this._next=null,this._head=null,this._tail=null,this.length=0;for(const s of t)this.add(s);this.forEach(e,i)}get(t){if(t<0||t>=this.length)throw new Error("index out of bounds");let e=this._head;for(let i=0;i<t;i++)e=e.next;return e?e.value:null}at(t){let e=this._head;for(let i=0;i<this.length;i++){if(e&&e.value.time===t)return e.value;e=e.next}return null}add(t){const e={value:t,next:null,previous:null};return this._head||(this._head=e,this._tail=e),this._tail?(e.previous=this._tail,this._tail.next=e,this._tail=e):this._head=this._tail=e,this.length++,e.value}remove(t){if(!this._head)return null;let e=this._head;if(e.value===t)return this._head=e.next,this.length--,e.value;for(;e.next;){if(e.next.value===t){const i=e.next;return e.next=e.next.next,e.next&&(e.next.previous=e),this._tail===i&&(this._tail=e),this.length--,i.value}e=e.next}return null}forEach(t,e){let i=this._head;if(i){e=e||this;let s=0;do{t.call(e,i.value,s),i=i.next,s++}while(i)}return this}slice(t,e=this.length){const i=[];let s=this._head,n=0;for(;n<t&&s;){s=s.next,n++}let o=0;for(;o<e-t&&s;){i.push(s.value),s=s.next,o++}return i}toArray(){const t=[];let e=this._head;for(;e;){t.push(e.value),e=e.next}return t}dispose(){return this._head=null,this._tail=null,this}}const nt={db:l,decibels:v,time:s,seconds:y,notation:T,note:w,hertz:h,frequency:n,normalRange:u,audioRange:c,transportTime:o,ticks:r,bpm:p,positive:d,integer:b,cents:f,degrees:m,milliseconds:g,midi:S,transportTime:k},ot=new WeakMap;function rt(t,e,i){ot.set(t,{value:e,units:i})}function at(t,e){if(t.units===n)return e;if(t.units===s)return t.toSeconds(e);if(t.units===l)return t.toDecibels(e);if(t.units===a)return e;{const i=I(t).toSeconds(e);return at(t,i)}}var lt=new Set;function ht(t){lt.add(t)}var ut=new Set;function ct(t){lt.forEach((e=>e(t)))}const dt={value:0},pt=(t,e,i,s,n)=>{const o=new st;for(const r of e)o.add({state:i,time:t.toSeconds(r)});const a=new st;for(const r of s)a.add({state:n,time:t.toSeconds(r)});return new pt(t,o,a)},ft=(t,e,i)=>{const s=new st,n=new st;e.forEach((e=>{s.add({state:"up",time:t.toSeconds(e.up)}),n.add({state:"down",time:t.toSeconds(e.down)})}));const o=new pt(t,s,n);return i.gain.value=o.getValueAtTime(t.now)>0?1:0,o.connect(i),o};class mt extends Q{constructor(){super(...arguments),this.name="Timeline",this.length=1/0,this._events=new st,this._scheduledEvents={}}get(t){return this._events.get(t)}at(t){const e=this.toSeconds(t);return this._events.at(e)}add(t){return this._assertAtTime(t.time),this._events.add(t),this}remove(t){return this._events.remove(t)}forEach(t){return this._events.forEach(t),this}forEachAtTime(t,e){const i=this.toSeconds(t);return this._events.forEach((t=>{t.time>=i&&e(t)})),this}forEachBetween(t,e,i){const s=this.toSeconds(t),n=this.toSeconds(e);return this._events.forEach((t=>{t.time>=s&&t.time<n&&i(t)})),this}slice(t,e){const i=this._events.slice(t,e);return new mt({context:this.context})._fromArray(i)}_fromArray(t){return this._events=new st(t),this}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}cancelAfter(t){return this.forEachFrom(t,(t=>this.remove(t))),this}forEachFrom(t,e){const i=this.toSeconds(t);return this._events.forEach((t=>{t.time>=i&&e(t)})),this}forEachBefore(t,e){const i=this.toSeconds(t);return this._events.forEach((t=>{t.time<i&&e(t)})),this}getPreviousEvent(t){const e=this.toSeconds(t),i=this._events.slice(0,this.length).reverse();for(const s of i)if(s.time<e)return s}getNextEvent(t){const e=this.toSeconds(t);for(const i of this._events.toArray())if(i.time>=e)return i}get last(){return this._events.toArray().pop()}get state(){return this._scheduledEvents}set state(t){}get size(){return this._events.length}clear(){return this.cancel(0)}_assertAtTime(t){if(t<0)throw new Error(`Events must be scheduled at a non-negative time. Given: ${t}`)}dispose(){return super.dispose(),this._events.dispose(),this._scheduledEvents={},this}}function gt(t,e){return t.time-e.time}class yt extends mt{constructor(){super(...arguments),this.name="TimelineState",this.initialState="stopped"}getLastState(t,e){const i=this.get(e);return i&&i.state===t?i:this.getPreviousEvent(e)}getStateAtTime(t){const e=this.getPreviousEvent(t);return e?e.state:this.initialState}setStateAtTime(t,e){this.add({state:t,time:e})}add(t){if(this._assertAtTime(t.time),this._events.add(t),this._events.toArray().sort(gt),this.at(t.time)===t){const e=this.getNextEvent(t.time+this.blockTime);e&&e.time>t.time&&(this.remove(e),e.time=t.time),this.getPreviousEvent(t.time)!==t&&this.remove(t)}}class vt extends Q{constructor(){super(...arguments),this.name="TimelineSignal",this.output=this.input=new Z({context:this.context,gain:0}),this._param=this.output.gain,this._events=new mt({context:this.context,length:0})}get value(){return this._param.value}set value(t){this._param.value=t}get units(){return a}get(t){const e=this._events.get(t);if(e)return e.value}at(t){const e=this._events.at(t);if(e)return e.value}setValueAtTime(t,e){const i=this.toSeconds(e);return this._events.add({time:i,value:t}),this.cancelScheduledValues(i+this.blockTime),this.setValueAtTime(t,i),this}linearRampToValueAtTime(t,e){const i=this.toSeconds(e);return this._events.add({time:i,value:t}),this.linearRampToValueAtTime(t,i),this}exponentialRampToValueAtTime(t,e){const i=this.toSeconds(e);return this._events.add({time:i,value:t}),this.exponentialRampToValueAtTime(t,i),this}setTargetAtTime(t,e,i){const s=this.toSeconds(e);return this.setTargetAtTime(t,s,i),this}setValueCurveAtTime(t,e,i,s=1){const n=this.toSeconds(e),o=this.toSeconds(i),r=t.map((t=>t*s));return this.setValueCurveAtTime(r,n,o),this}cancelScheduledValues(t){const e=this.toSeconds(t);return this._events.cancel(e),this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),i=this.getValueAtTime(e);return this.cancelScheduledValues(e),this._param.setValueAtTime(i,e),this}rampTo(t,e=0){return this.setTargetAtTime(t,this.now,this.toSeconds(e)),this}getValueAtTime(t){const e=this.toSeconds(t),i=this._events.getPreviousEvent(e);if(!i)return 0;const s=this._events.getNextEvent(e);let n=0;if(!s)n=i.value;else if(s.time===i.time)n=i.value;else{let t=this._param.getValueAtTime(s.time);t=Y(i.value,s.value,(e-i.time)/(s.time-i.time))}return n}dispose(){return super.dispose(),this._events.dispose(),this._param.disconnect(),this}}function bt(t){if(t.length>1 && t.startsWith("+"))return t.substr(1);if(t.length>1 && t.startsWith("-"))return-1*parseFloat(t.substr(1));const e=parseFloat(t);return isNaN(e)?0:e}function Tt(t){return t.startsWith("+")}function wt(t){return t.startsWith("-")}const St=/^(\d+(\.\d+)?|\.\d+)(s|hz|ms|i|tr|n)$/i;function kt(t,e,i){if(function(t){return St.test(t)}(t)){const s=t.match(St)[3];return s.toLowerCase()===e.toLowerCase()}const s=bt(t);return i.has(s)?i.get(s):null}const xt=new Map([[-1,"-"],["+","-"],["-","-"]]),Ot=new Map([[!0,"-"],["-","-"]]);function Ct(t,e,i,s){const n=bt(t);let o=kt(t,e,i);null===o&&(o=s.has(n)?s.get(n):0);let r=0;if(function(t){return wt(t)&&t.length>1}(t)){const e=t.substr(1).match(/[a-g#b]+/);e&&(r=Ot.has(e[0].includes("b"))||0)}else if(function(t){return Tt(t)&&t.length>1}(t)){const e=t.substr(1).match(/[a-g#b]+/);e&&(r=xt.has(e[0].includes("#"))||0)}return o+r}const Mt=/^(\d+)/;function At(t,e){const i=t.match(Mt);if(!i)return 0;let s=parseInt(i[1]);const n=t.split(":");if(2===n.length){const t=parseFloat(n[1]);s+=t/e}return s}const Pt=new Map([["w",4],["h",2],["q",1],["e",.5],["s",.25],["t",.125],["x",.0625],["o",.03125]]);function Dt(t,e){const i=t.match(/[whqestxo]$/);if(i){const t=i[0],s=Pt.get(t),n=new RegExp(`(\\d*)(${t.replace(".","\\.")})`),o=t.match(n),r=o&&o[1]?parseInt(o[1]):1;let a=0;return t.includes(".")&&(a=t.length-1),s*r*(2-1/(2**a))*e}}let Et=E;const It={get:t=>Et,set context(t){Et=t,I(t).rawContext!==Et.rawContext&&lt.forEach((e=>e(t)))}};var Lt,Rt,Ft=It;const Nt={get context(){return E},set context(t){I(t).rawContext!==E.rawContext&&(E=P(t.rawContext),C.set(t,E),ct(E)),lt.forEach((e=>e(E)))},supported:!0,now:()=>E.now,immediate:()=>E.immediate,resume:()=>E.resume(),on:ht,off:t=>lt.delete(t)};function Bt(t){return(t-440)/1200*Math.log(2)+Math.log(440)}function Vt(t,e,i){const s=1e3*t,n=20*(s-e),o=Math.floor(n/i);return e+o/1e3*i}function zt(t,e){for(let i=0;i<Math.max(t.length,e.length);i++){const s=t[i]||0,n=e[i]||0;if(s>n)return 1;if(n>s)return-1}return 0}class Gt extends Q{constructor(){super(...arguments),this.name="Midi",this.value=arguments[0]}toMidi(){return this.value}toNote(){const t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],e=Math.floor(this.value/12)-1,i=this.value%12;return t[i]+e.toString()}toFrequency(){const t=440*2**((this.value-69)/12);return h.toFrequency(t)}}function Wt(t){return new Gt(t).toFrequency()}function Ut(t){return new Gt(t).toNote()}function jt(t){const e=Math.log2(t/440);return Math.round(12*e)+69}const Ht={A0:21,B0:23,C1:24,D1:26,E1:28,F1:29,G1:31,A1:33,B1:35,C2:36,D2:38,E2:40,F2:41,G2:43,A2:45,B2:47,C3:48,D3:50,E3:52,F3:53,G3:55,A3:57,B3:59,C4:60,D4:62,E4:64,F4:65,G4:67,A4:69,B4:71,C5:72,D5:74,E5:76,F5:77,G5:79,A5:81,B5:83,C6:84,D6:86,E6:88,F6:89,G6:91,A6:93,B6:95,C7:96,D7:98,E7:100,F7:101,G7:103,A7:105,B7:107,C8:108};function qt(t){if("string"!=typeof t)return jt(t);const e=t.match(/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i);if(e){const t=e[1].toUpperCase(),i=e[2],s={C:0,"C#":1,"D":2,"D#":3,E:4,F:5,"F#":6,G:7,"G#":8,A:9,"A#":10,B:11}[t];s.Cbb=s.C-2,s.Cb=s.C-1,s.C=s.C,s.Cx=s.C+2,s["C##"]=s.C+2;const n=s[t];return 12*(parseInt(i)+1)+n}return Ht[t]||0}class Kt extends Q{constructor(){super(...arguments),this.name="Frequency",this.value=arguments[0]}toMidi(){return jt(this.value)}toNote(){return Ut(this.toMidi())}transpose(t){return new Kt(this.value*2**(t/12))}harmonic(t=1){return new Kt(this.value*t)}}function Yt(t){return new Kt(t).toMidi()}function Xt(t){return new Kt(t).toNote()}function Zt(t,e=0){return t*2**(e/1200)}const Qt={"1m":-1,"1d":-2,"2m":1,M2:2,"2A":3,"3m":3,M3:4,"3A":5,"4d":4,P4:5,"4A":6,"5d":6,P5:7,"5A":8,"6m":8,M6:9,"6A":10,"7d":9,"7m":10,M7:11,"7A":12};function Jt(t,e){const i=qt(t),s=Qt[e];return Wt(i+s)}function $t(t,e){return Object.values(Qt).includes(t-qt(e))}let te=E;const ee={get:()=>te,set context(t){te=t,I(t).rawContext!==te.rawContext&&lt.forEach((e=>e(t)))}};const ie={get context(){return ee.get()},set context(t){I(t).rawContext!==ee.get().rawContext&&(ee.context=P(t.rawContext),C.set(t,ee.get()),ct(ee.get())),lt.forEach((e=>e(ee.get())))},defaults:tt.defaults,supported:O && B(O.prototype.createGain),now:()=>ee.get().now,immediate:()=>ee.get().immediate,Destination:Q.Destination,Draw:Vt,Transport:Ft,Buffer:ut,Offline:U,start:async()=>ie.supported?E.resume():Promise.resolve()};class se extends tt{constructor(){super(...arguments),this.name="Signal",this._constantSource=this.context.createConstantSource(),this._constantSource.start(0),this._param=this._constantSource.offset,this.input=void 0,this.output=this._constantSource}get value(){return this._param.value}set value(t){const e=this.now;this.cancelScheduledValues(e),this._param.setValueAtTime(t,e)}get units(){return a}connect(t,e=0,i=0){return this._constantSource.connect(t,e,i),this}disconnect(t,e,i){if(!t)return this._constantSource.disconnect(),this;this._constantSource.disconnect(t,e,i)}setValueAtTime(t,e){return this._param.setValueAtTime(t,this.toSeconds(e)),this}setRampPoint(t){return this._param.setRampPoint(this.toSeconds(t)),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,this.toSeconds(e)),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,this.toSeconds(e)),this}setTargetAtTime(t,e,i){return this._param.setTargetAtTime(t,this.toSeconds(e),i),this}setValueCurveAtTime(t,e,i){return this._param.setValueCurveAtTime(t,this.toSeconds(e),this.toSeconds(i)),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(this.toSeconds(t)),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(this.toSeconds(t)),this}rampTo(t,e=0){return this.setTargetAtTime(t,this.now,this.toSeconds(e)),this}dispose(){return super.dispose(),this._constantSource.disconnect(),this._constantSource.stop(),this}}const ne=/^(\d+(\.\d+)?|\.\d+)(s|hz|ms|i|tr|n)$/i;function oe(t,e,i){if(function(t){return ne.test(t)}(t)){const s=t.match(ne)[3];return s.toLowerCase()===e.toLowerCase()}const s=bt(t);return i.has(s)?i.get(s):null}const re=new Map([[-1,"-"],["+","-"],["-","-"]]),ae=new Map([[!0,"-"],["-","-"]]);function le(t,e,i,s){const n=bt(t);let o=oe(t,e,i);null===o&&(o=s.has(n)?s.get(n):0);let r=0;if(function(t){return wt(t)&&t.length>1}(t)){const e=t.substr(1).match(/[a-g#b]+/);e&&(r=ae.has(e[0].includes("b"))||0)}else if(function(t){return Tt(t)&&t.length>1}(t)){const e=t.substr(1).match(/[a-g#b]+/);e&&(r=re.has(e[0].includes("#"))||0)}return o+r}const he=/^(\d+)/;function ue(t,e){const i=t.match(he);if(!i)return 0;let s=parseInt(i[1]);const n=t.split(":");if(2===n.length){const t=parseFloat(n[1]);s+=t/e}return s}const ce=new Map([["w",4],["h",2],["q",1],["e",.5],["s",.25],["t",.125],["x",.0625],["o",.03125]]);function de(t,e){const i=t.match(/[whqestxo]$/);if(i){const t=i[0],s=ce.get(t),n=new RegExp(`(\\d*)(${t.replace(".","\\.")})`),o=t.match(n),r=o&&o[1]?parseInt(o[1]):1;let a=0;return t.includes(".")&&(a=t.length-1),s*r*(2-1/(2**a))*e}}class pe extends Q{constructor(){const t=tt(arguments[0]);super(t);const e=this.context.createOscillator();this._oscillator=e,this.type=e.type,this.frequency=new it({context:this.context,param:e.frequency,units:"hertz",value:440}),this.detune=new it({context:this.context,param:e.detune,units:"cents",value:0}),this._state=new yt({context:this.context}),this._state.setStateAtTime("stopped",this.now),this.input=void 0,this.output=new Z(this.context)}get state(){return this._state.getStateAtTime(this.now)}start(t){const e=this.toSeconds(t);return e<this.now && this._state.getStateAtTime(e) !== "started"&&(e=this.now),this._state.setStateAtTime("started",e),this._oscillator.start(e),this}stop(t){const e=this.toSeconds(t);return e<this.now&&(e=this.now),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.context.setTimeout((()=>{this._oscillator.stop(),this.onstop(this)}),e-this.now),this}restart(t){const e=this.toSeconds(t);return this.stop(e),this.start(e),this}onstop(){}set(t){if(t.type)this.type=t.type;if(t.frequency)this.frequency.value=t.frequency;if(t.detune)this.detune.value=t.detune;if(t.onstop)this.onstop=t.onstop}sync(){return this}unsync(){return this}dispose(){return super.dispose(),this._state.dispose(),this.frequency.dispose(),this.detune.dispose(),this._oscillator.disconnect(),this}}class fe extends pe{constructor(){const t=tt(arguments[0]);super(t),this.name="Source",this.output=new Z(this.context),this._volume=this.output,this.volume=new it({context:this.context,param:this._volume.gain,units:"decibels",value:0}),this._state.setStateAtTime("stopped",0),this._synced=!1,this._syncedStart=this.context.transport.now,this._syncedStop=this.context.transport.now,this.onended=()=>{}}get state(){return this._state.getStateAtTime(this.now)}get mute(){return this.volume.value===-1/0}set mute(t){t&&this.volume.value!==-1/0?this.volume.value=-1/0:!t&&this.volume.value===-1/0&&(this.volume.value=0)}start(t,e,i){let s;s=this.toSeconds(t);const n=this.toSeconds(e),o=this.toSeconds(i);return this._start(s,n,o),this}stop(t){const e=this.toSeconds(t);this._stop(e)}restart(t,e,i){const s=this.toSeconds(t),n=this.toSeconds(e),o=this.toSeconds(i);return this.stop(s),this.start(s,n,o),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=this.context.transport.schedule((t=>{this.start(t)})),this._syncedStop=this.context.transport.scheduleRepeat((t=>{this.state==="started"&&this.stop(t)}),1)),this}unsync(){return this._synced&&(this._synced=!1,this.context.transport.clear(this._syncedStart),this.context.transport.clear(this._syncedStop)),this}set(t){if(t.mute)this.mute=t.mute;if(t.volume)this.volume.value=t.volume;super.set(t)}dispose(){return super.dispose(),this._state.dispose(),this.volume.dispose(),this.unsync(),this.onended=()=>{},this}}class me extends tt{constructor(){const t=tt(arguments[0]);super(t),this.name="LFO",this._oscillator=new pe(Object.assign(t,{context:this.context})),this.frequency=this._oscillator.frequency,this.frequency.value=t.frequency,this.detune=this._oscillator.detune,this.detune.value=t.detune,this.amplitude=new it({context:this.context,param:new Z(this.context).gain,units:"normalRange",value:t.amplitude}),this._stopped=new se({context:this.context,value:1}),this._a2g=new Z(this.context),this._amplitudeGain=new Z(this.context),this._gain=new Z(this.context),this.input=void 0,this.output=this._gain,this.min=t.min,this.max=t.max,this.phase=t.phase,this.units=t.units,this.convert=t.convert,this.type=t.type}get state(){return this._oscillator.state}start(t){return t=this.toSeconds(t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._oscillator.stop(t),this}sync(){return this}unsync(){return this}set(t){if(t.min)this.min=t.min;if(t.max)this.max=t.max;if(t.phase)this.phase=t.phase;if(t.type)this.type=t.type;this._oscillator.set(t)}connect(t,e,i){return t.constructor.name==="Param"?this.chain(this._gain,t.inputFrom(this,e,i)):super.connect(t,e,i),this}dispose(){return super.dispose(),this._oscillator.dispose(),this.amplitude.dispose(),this._stopped.dispose(),this._a2g.dispose(),this._gain.dispose(),this._amplitudeGain.dispose(),this}}class ge extends fe{constructor(){const t=tt(arguments[0]);super(t),this.name="Oscillator",this._oscillator=new pe(Object.assign(t,{context:this.context,onstop:()=>this.onstop(this)})),this.frequency=this._oscillator.frequency,this.detune=this._oscillator.detune,this.phase=t.phase,this.type=t.type,this.partials=t.partials,this.partialCount=t.partialCount,this.input=void 0,this.output=new Z(this.context),this._volume=this.output,this.volume=this._volume.gain}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get partials(){return this._oscillator.partials}set partials(t){this._oscillator.partials=t}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._oscillator.partialCount=t}_start(t){this._oscillator.start(t),this._oscillator.connect(this.output)}_stop(t){this._oscillator.stop(t)}restart(t){this._oscillator.restart(t)}onstop(t){}dispose(){return super.dispose(),this._oscillator.dispose(),this}}class ye extends tt{constructor(){const t=tt(arguments[0]);super(t),this.name="Envelope",this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.decayCurve=t.decayCurve,this.releaseCurve=t.releaseCurve,this._sig=new se({context:this.context,value:0}),this.output=this._sig,this.input=void 0}get value(){return this._sig.value}_getCurve(t,e,i){if(t==="linear")return this._sig.linearRampToValueAtTime(i,e);if(t==="exponential")return this._sig.exponentialRampToValueAtTime(i,e);{if(Array.isArray(t)){const s=new Float32Array(t.length);for(let e=0;e<s.length;e++)s[e]=Y(0,1,t[e]);return this._sig.setValueCurveAtTime(s,e,i-e)}throw new Error("Invalid curve type")}}_attackDecay(t,e){const i=this.toSeconds(this.attack),s=this.toSeconds(this.decay);return this._getCurve(this.attackCurve,t,i),this._getCurve(this.decayCurve,t+i,this.sustain*e),this}triggerAttack(t,e=1){const i=this.toSeconds(t);return this._sig.cancelScheduledValues(i),this._sig.setValueAtTime(0,i),this._attackDecay(i,e),this}triggerRelease(t){const e=this.toSeconds(t);return this._sig.cancelScheduledValues(e),this._sig.setTargetAtTime(0,e,this.toSeconds(this.release)),this}triggerAttackRelease(t,e,i=1){const s=this.toSeconds(e);return this.triggerAttack(s,i),this.triggerRelease(s+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t){return this._sig.connect(t),this}dispose(){return super.dispose(),this._sig.dispose(),this}}class ve extends tt{constructor(){const t=tt(arguments[0]);super(t),this.name="AmplitudeEnvelope",this.input=this.output=new Z(this.context),this._sig=new se({context:this.context,value:0}),this._sig.connect(this.output.gain)}triggerAttack(t,e){return this._sig.triggerAttack(t,e),this}triggerRelease(t){return this._sig.triggerRelease(t),this}triggerAttackRelease(t,e,i){return this._sig.triggerAttackRelease(t,e,i),this}connect(t,e,i){this.output.connect(t,e,i)}dispose(){return super.dispose(),this._sig.dispose(),this}}class be extends fe{constructor(){const t=tt(arguments[0]);super(t),this.name="Noise",this.type=t.type,this.playbackRate=t.playbackRate,this._source=this.context.createBufferSource(),this._source.loop=!0;const e=this.context.createBuffer(2,this.context.sampleRate,this.context.sampleRate),i=e.getChannelData(0),s=e.getChannelData(1);for(let t=0;t<i.length;t++)i[t]=2*Math.random()-1,s[t]=2*Math.random()-1;this._source.buffer=e,this._source.connect(this.output)}get type(){const t=this._source.playbackRate.value;return t>0&&t<10?"brown":t>10?"pink":"white"}set type(t){"white"===t?this._source.playbackRate.value=1:"brown"===t?this._source.playbackRate.value=.1:"pink"===t&&(this._source.playbackRate.value=.01)}_start(t){this._source.start(t)}_stop(t){this._source.stop(t)}restart(t){this._source.stop(t),this._source.start(t)}dispose(){return super.dispose(),this._source.disconnect(),this}}class Te extends tt{constructor(){const t=tt(arguments[0]);super(t),this.name="Instrument",this.input=this.output=new Z(this.context),this._volume=this.output,this.volume=new it({context:this.context,param:this._volume.gain,units:"decibels",value:0})}get mute(){return this.volume.value===-1/0}set mute(t){this.volume.value=t?-1/0:0}triggerAttack(t,e,i){const s=this.toSeconds(e),n=this.toFrequency(t);this.triggerAttack(n,s,i)}triggerRelease(t,e){const i=this.toSeconds(e);this.triggerRelease(t,i)}triggerAttackRelease(t,e,i,s){const n=this.toSeconds(i),o=this.toFrequency(t),r=this.toSeconds(e);this.triggerAttack(o,n,s),this.triggerRelease(n+r)}sync(){return this}unsync(){return this}set(t){if(t.mute)this.mute=t.mute;if(t.volume)this.volume.value=t.volume}dispose(){return super.dispose(),this.volume.dispose(),this}}class we extends fe{constructor(){const t=tt(arguments[0]);super(t),this.name="PulseOscillator",this._width=new se({context:this.context,units:"audioRange",value:t.width}),this._oscillator=new ge(Object.assign(t,{context:this.context,type:"square"})),this.frequency=this._oscillator.frequency,this.detune=this._oscillator.detune,this._shaper=new WaveShaper({context:this.context,length:4096}),this._oscillator.connect(this._shaper),this._shaper.connect(this._width),this._width.connect(this.output),this.width.value=t.width,this.phase=t.phase}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get width(){return this._width.signal}get type(){return"pulse"}get partials(){return[]}get partialCount(){return 0}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}restart(t){this._oscillator.restart(t)}onstop(t){}dispose(){return super.dispose(),this._oscillator.dispose(),this._width.dispose(),this._shaper.dispose(),this}}class Se extends tt{constructor(){const t=tt(arguments[0]);super(t),this.name="PWMOscillator",this.source=new we(Object.assign(t,{context:this.context})),this.frequency=this.source.frequency,this.detune=this.source.detune,this.modulationFrequency=new me(Object.assign(t,{context:this.context})).frequency,this.modulationFrequency.value=t.modulationFrequency,this.phase=t.phase,this.modulationFrequency.connect(this.source.width),this.source.connect(this.output)}get type(){return"pwm"}get phase(){return this.source.phase}set phase(t){this.source.phase=t}get partials(){return[]}get partialCount(){return 0}_start(t){this.source.start(t),this.modulationFrequency.start(t)}_stop(t){this.source.stop(t),this.modulationFrequency.stop(t)}restart(t){this.source.restart(t),this.modulationFrequency.restart(t)}onstop(t){}dispose(){return super.dispose(),this.source.dispose(),this.modulationFrequency.dispose(),this}}class ke extends tt{constructor(){const t=tt(arguments[0]);super(t),this.name="MonoSynth",this.frequency=new se({context:this.context,units:"hertz",value:t.frequency}),this.detune=new se({context:this.context,units:"cents",value:t.detune}),this.oscillator=new ge(Object.assign(t.oscillator,{context:this.context})),this.envelope=new ve(Object.assign(t.envelope,{context:this.context})),this.filter=new BiquadFilter(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new ye(Object.assign(t.filterEnvelope,{context:this.context})),this.input=void 0,this.output=new Z(this.context),this._volume=this.output,this.volume=this.output.gain,this.portamento=t.portamento,this.oscillator.chain(this.filter,this.envelope,this.output),this.frequency.connect(this.oscillator.frequency),this.detune.connect(this.oscillator.detune),this.filterEnvelope.connect(this.filter.frequency),this.volume.value=t.volume}triggerAttack(t,e,i=1){const s=this.toSeconds(e);this.frequency.setValueAtTime(t,s),this.envelope.triggerAttack(s,i),this.filterEnvelope.triggerAttack(s,i)}triggerRelease(t){const e=this.toSeconds(t);this.envelope.triggerRelease(e),this.filterEnvelope.triggerRelease(e)}triggerAttackRelease(t,e,i,s=1){const n=this.toSeconds(i),o=this.toSeconds(e);this.triggerAttack(t,n,s),this.triggerRelease(n+o)}setNote(t,e){this.frequency.setTargetAtTime(t,this.toSeconds(e),this.portamento)}getLevelAtTime(t){return this.envelope.getValueAtTime(t)}sync(){return this}unsync(){return this}set(t){if(t.portamento)this.portamento=t.portamento;if(t.oscillator)this.oscillator.set(t.oscillator);if(t.envelope)this.envelope.set(t.envelope);if(t.filter)this.filter.set(t.filter);if(t.filterEnvelope)this.filterEnvelope.set(t.filterEnvelope)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filter.dispose(),this.filterEnvelope.dispose(),this.frequency.dispose(),this.detune.dispose(),this}}class xe extends Te{constructor(){const t=tt(arguments[0]);super(t),this.name="Synth",this.oscillator=new ge(Object.assign(t.oscillator,{context:this.context})),this.envelope=new ve(Object.assign(t.envelope,{context:this.context})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.portamento=t.portamento,this.oscillator.chain(this.envelope,this.output),this.volume.value=t.volume}triggerAttack(t,e,i=1){const s=this.toSeconds(e);this.oscillator.frequency.setTargetAtTime(t,s,this.portamento),this.oscillator.start(s),this.envelope.triggerAttack(s,i)}triggerRelease(t){const e=this.toSeconds(t);this.oscillator.stop(e+this.toSeconds(this.envelope.release)),this.envelope.triggerRelease(e)}setNote(t,e){this.oscillator.frequency.setTargetAtTime(t,this.toSeconds(e),this.portamento)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}t.AmplitudeEnvelope=ve,t.Buffer=ut,t.Destination=Nt,t.Draw=Vt,t.Envelope=ye,t.Frequency=Kt,t.LFO=me,t.Midi=Gt,t.MonoSynth=ke,t.Noise=be,t.Offline=U,t.Oscillator=ge,t.PWMOscillator=Se,t.Param=it,t.PulseOscillator=we,t.Signal=se,t.Source=fe,t.Synth=xe,t.Timeline=mt,t.TimelineSignal=vt,t.TimelineState=yt,t.Tone=ie,t.Transport=Ft,t.context=E,t.get=function(){return E},t.now=function(){return E.now},t.setContext=function(t){t instanceof A?E=t:"undefined"!=typeof AudioContext&&t instanceof AudioContext&&(E=new A(t))},t.start=async function(){return await E.resume(),Promise.resolve()},Object.defineProperty(t,"__esModule",{value:!0})}));

    </script>
    
    <script>
        const testBtn = document.getElementById('test-btn');
        let synth;

        testBtn.addEventListener('click', () => {
            console.log('Button clicked.');

            if (typeof Tone === 'undefined') {
                alert('Error: Tone.js library did not load.');
                return;
            }

            if (!synth) {
                try {
                    Tone.start();
                    synth = new Tone.Synth().toDestination();
                    console.log('Audio context started successfully.');
                } catch (e) {
                    alert('An error occurred while starting the audio: ' + e.message);
                    console.error(e);
                    return;
                }
            }

            try {
                if (synth && Tone.context.state === 'running') {
                    console.log('Playing sound...');
                    synth.triggerAttackRelease('C4', '0.5');
                } else {
                    alert('Audio context is not running. Please tap the button again.');
                    console.warn('Audio context not in a running state.');
                }
            } catch (e) {
                alert('An error occurred while playing the sound: ' + e.message);
                console.error(e);
            }
        });
    </script>
</body>
</html>
